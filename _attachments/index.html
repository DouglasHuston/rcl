<!DOCTYPE html>
<html>
	<head>
		<title>Reformed Churches Locator</title>
		<link rel="stylesheet" href="style/main.css" type="text/css">
	</head>
	<body>
		<div id="header">
			<h1>Reformed Churches Locator
			<span class="subtitle">The Ultimate Directory of Reformed Churches Worldwide</span></h1>
		</div>
		<ul id="mainmenu"></ul>

		<div id="content"></div>

        <script type="text/template" id="find_a_church_template">
            <div id="congregations">
                <div id="account" style="float: right"></div>
                <h2>Congregations</h2>
                <div class="ui-widget ui-widget-content ui-corner-all">
                    <div>
                        <div id="map"></div>
                        <div id="search_container"></div>
                        <div id="congregations_container"></div>
                    </div>

                    <div id="pager" class="pager"></div>
                </div>
            </div>
            <div id="footer">
                <div class="clearingdiv"></div>
            </div>
        </script>
        
        <script type="text/template" id="map_template">
            <div id="map_canvas" style="width: 914px; height: 500px;"></div>
        </script>

        <script type="text/template" id="import_directory_template">
               <div id="congregations">
            <h1>Congregations - configure downloading congregation data from one directory</h1>
            <p>If you make a mistake, just <a href='/import_directory'>reload this page</a> and start over.</p>
            
            <div id='dir_and_display_type'>
                <h2>Step 1:  Please enter the URL of the church directory page or RSS feed</h2>
                <input type='text' name='url' id='url' value='http://opc.org/locator.html'/>
                <div id='rss_feed' style='display:none'>
                    <h2>RSS feed - Does the data below look correct?</h2>
                    <div id='rss_data_formatted'></div>
                    <input type='radio' name='rss_data_correct' value='yes' />Yes<br />
                    <input type='radio' name='rss_data_correct' value='no' />No
                </div>
                <p>Please enter the name of this directory's denomination or group of congregations</p>
                <input type='text' name='cgroup_name' id='cgroup_name' value='Orthodox Presbyterian Church'/>
                <p>Please enter an abbreviation for this denomination or group of congregations</p>
                <input type='text' name='abbreviation' id='abbreviation' value='OPC'/>
            </div>
            
            <div id='directory_type' style='display:none'>
                <h2>Step 2:  Are all the congregations on:</h2>
                <input type='radio' name='type' value='one page' />one page, or<br />
                <input type='radio' name='type' value='one state per page' />one state per page?
            </div>
            <div id='state_page' style='display:none'>
                <h2>Step 3:  Click the drop-down box that lets you pick a state</h2>
                <div id='state_drop_down_selector' class='content_frame'></div>
            </div>
    
            <div id='cong_details_url' style='display:none'>
                <h2>Step 4:  Click the link that leads to the page that displays the details of one congregation</h2>
                <div id='cong_details_url_selector' class='content_frame'></div>
            </div>
            <div id='cong_details_fields' style='display:none'>
                <h2>Step 5:  Select congregation details</h2>
                <p>
                    <ul>
                        <li>
                            The interface below allows you to tell us where each piece of data about this congregation is located 
                            in the HTML of the page.
                        </li>
                        <li>
                            For each field listed below, please click in the field's text box, then highlight that field's content where
                            it appears in the page below.
                        </li>
                        <li>
                            Behind the scenes, this page will use your selected text to create a regular expression that will attempt to 
                            extract that field's data from the web page.  Then it will display the data it extracted in that field's text box.
                        </li>
                        <li>
                            Once that data displays in the text box, please confirm whether the data is correct.  If it is correct, simply 
                            move on to the next text box.  If it is not correct, please click the button that says "No, this isn't right" 
                            and our code will modify the regular expression and try again.  You may click the "No, this isn't right button 
                            more than once.  Every time you click it, our code expands the regular expression to include more context around 
                            the data you have selected, to attempt to help the regular expression better recognize the specific piece of data
                            you have selected.
                        </li>
                        <li>
                            If you would like to modify the regular expression yourself, you may do so in the "Regular Expression" box at the 
                            bottom of the page.  We encourage you to do so.  You can read documentation about the regular expression syntax at
                            <a href='http://docs.python.org/library/re.html#regular-expression-syntax' target='_blank'>Python Regular Expression Syntax</a>.
                        </li> 
                    </ul>
                </p>
                <table id='fields_table'>
                    <tr py:for="f in fields">
                        <td>
                            ${f['pretty_name']}
                        </td>
                        <td>
                            <input type='text' name='${f["db_name"]}' id='${f["db_name"]}' />
                            <br />
                            <button id='${f["db_name"]}_button' style='display:none'>No, this isn't right</button>
                        </td>
                    </tr>
                </table>
                <div id='cong_details_fields_selector' class='content_frame content_frame_narrow'></div>
                <h2>Edit regex here</h2>
                <p>
                    Please replace text that should NOT be part of the regex 
                    (because it is data that should go into another field)
                    with this expression:  <code>.*?</code>
                </p>
                <p>
                    For example, if you are choosing the mailing state, change this:<br />
                    &nbsp; &nbsp;<code>P\\\.O\\\. Box 873741&lt;br&gt;Wasilla, (?P&lt;mailing_state&gt;.+) 99687-3741</code><br />
                    into this:<br />
                    &nbsp; &nbsp;<code>.*?&lt;br&gt;.*?, (?P&lt;mailing_state&gt;.+) .*?</code>
                </p>
                <textarea cols="67" rows="2" id="details_regex" ></textarea>
                
                <h2>Result:</h2>
                <div id="result_div"></div>
            </div>
                
        </div>

        </script>
		
		<script type="text/template" id="congregations_template">
			<table id="congregation_list" class="tablesorter">
    			<thead>
        			<tr>
            			<th>Congregation name</th>
            			<th>City, State</th>
            			<th>Contact info</th>
        			</tr>
    			</thead>
    			<tbody>
        			<tr class="odd">
            			<td class="cong_info"><a href="http://127.0.0.1:8080/cong/1">Caney
            			OPC</a></td>
            			<td class="cong_info">Caney, KS, US</td>
            			<td class="cong_info"><a href="http:" class="external"
            			title="Visit Caney OPC online" target="_blank"></a></td>
        			</tr>
        			<tr class="even">
            			<td class="cong_info">
            			 <a href="http://127.0.0.1:8080/cong/2">CrossPoint Baptist Church</a></td>
            			<td class="cong_info">Caney, KS, US</td>
            			<td class="cong_info">
            			 <a href="http:" class="external" title="Visit CrossPoint Baptist Church online" target="_blank"></a>
            			</td>
        			</tr>
    			</tbody>
			</table>
		</script>
		<script type="text/template" id="menu_template">
			<li class="first"><a href="/find_a_church" id="find_a_church">Find a church</a></li>
			<li><a href="/import_directory" id="import_directory">Import a directory</a></li>
			<li><a href="#" id="delete_all_docs">Delete all:</a></li>
			<li><a href="#" id="delete_all_opc_cgroups">OPC cgroups</a></li>
			<li><a href="#" id="delete_all_directories">directories</a></li>
			<li><a href="#" id="delete_all_caney_opc">Caney OPC</a></li>
			<li><a href="#" id="delete_all_opc_data">OPC data</a></li>
		</script>

		<script type="text/template" id="search_template">

			<div>
    			<form action="TODO: write this!">
        			<span class="watermark_container"
        			style="display: inline-block; position: relative;">
        			 <span
            			class="watermark"
            			style="position: absolute; font-family: Verdana, Arial, sans-serif; font-size: 18px; color: rgb(153, 153, 153); left: 6px; top: 2px; height: 28px; line-height: 28px; text-align: left; pointer-events: none;">Enter
        			 location
        			 </span>
        			 <input class="jq_watermark" title="Enter location" type="text" name="location" id="search_the_map">
        			</span>
        			Search within
        			<select title="Search within" name="radius" id="radius">
            			<option value="5">5</option>
            			<option value="10">10</option>
            			<option value="25">25</option>
            			<option value="50">50</option>
            			<option value="100">100</option>
            			<option value="250">250</option>
        			</select>
        			<select title="unit of measurement" name="units" id="units">
            			<option value="miles">miles</option>
            			<option value="km">km</option>
        			</select>
        			<input type="button" value="Search" id="search">
    			</form>
    			<form action="TODO">
        			<span class="watermark_container"
        			style="display: inline-block; position: relative;"><span
        			class="watermark"
        			style="position: absolute; font-family: Verdana, Arial, sans-serif; font-size: 18px; color: rgb(153, 153, 153); left: 6px; top: 2px; height: 28px; line-height: 28px; text-align: left; pointer-events: none;">Enter
        			keyword</span><input class="jq_watermark" title="Enter keyword" type="text"
        			name="keyword" id="keyword"></span>
    			</form>
			</div>
			<div>
    			<form action="TODO">
        			<span class="watermark_container"
        			style="display: inline-block; position: relative;"><span
        			class="watermark"
        			style="position: absolute; font-family: Verdana, Arial, sans-serif; font-size: 18px; color: rgb(153, 153, 153); left: 6px; top: 2px; height: 28px; line-height: 28px; text-align: left; pointer-events: none;">Enter
        			state</span><input class="jq_watermark" title="Enter state" type="text"
        			name="state" id="state"></span>
    			</form>
			</div>
			<div id="group_filter">
    			Filter: <span> <a href="TODO">OPC</a>
    			</span><span> <a href="TODO">PCA</a>
    			</span>
			</div>

		</script>

	</body>

	<!--  Couchapp JavaScript files -->

	<script src="vendor/couchapp/loader.js"></script>
	<script>
		couchapp_load(["vendor/couchapp/jquery.couchLogin.js"])
	</script>

	<!-- Reformed Churches Locator JavaScript files -->
	<!-- TODO: Put these script & CSS loads into their associated widgets -->

	<script src="script/jquery-ui-1.8.18.custom/js/jquery-ui-1.8.18.custom.min.js"></script>
	<link rel="stylesheet" type="text/css" href="script/jquery-ui-1.8.18.custom/css/ui-lightness/jquery-ui-1.8.18.custom.css" media="all">
	<link rel="stylesheet" type="text/css" href="script/jquery.tablesorter/ui.css" media="all">
	<script src="script/jquery.tablesorter/jquery.tablesorter-ui.js"></script>
	<script src="script/jquery.tablesorter/addons/pager/jquery.tablesorter.pager.js"></script>
	<link rel="stylesheet" type="text/css" href="script/jquery.tablesorter/addons/pager/jquery.tablesorter.pager.css" media="all">
	<script src="script/jquery.watermark/jquery.watermark.min_.js"></script>
	<!-- TODO: Put this script into app.js -->
	<!-- <script src="script/search_the_map.js"></script> -->
	<script type="text/javascript" src="script/lib/underscore.js"></script>
	<script type="text/javascript" src="script/lib/backbone.js"></script>
	<script type="text/javascript" src="script/lib/backbone-relational.js"></script>
	<script type="text/javascript" src="script/lib/backbone-couchdb.js"></script>
	<!-- <script type="text/javascript" src="script/lib/backbone.couch.js"></script> -->
	<!-- <script type="text/javascript" src="script/lib/backbone.couchdb.js"></script> -->

	<script data-main="script/main" src="script/require.js"></script>
	<script src="script/app.js"></script>
	
	<!-- Jasmine unit testing files -->
    <link rel="stylesheet" type="text/css" href="script/lib/jasmine-standalone-1.2.0/lib/jasmine-1.2.0/jasmine.css">
    <script type="text/javascript" src="script/lib/jasmine-standalone-1.2.0/lib/jasmine-1.2.0/jasmine.js"></script>
    <script type="text/javascript" src="script/lib/jasmine-standalone-1.2.0/lib/jasmine-1.2.0/jasmine-html.js"></script>
    
    <!-- include test spec files here... -->
    <script type="text/javascript" src="script/lib/jasmine-standalone-1.2.0/spec/rcl.js"></script>


</html>
